(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{MYbz:function(n,l,e){"use strict";e.d(l,"a",(function(){return t})),e("wfUc");class t{}},Um7L:function(n,l,e){"use strict";e.d(l,"a",(function(){return t}));class t{}},wfUc:function(n,l,e){"use strict";e.d(l,"a",(function(){return t}));class t{constructor(n,l,e){this._userService=n,this._chatService=l,this._socket=e,this.messages=[],this.chatuser={_id:"",username:"",password:"",email:"",profilePicUrl:"",friends:null,requests:null},this.textMsg="",this.online=!1}ngOnInit(){this.user=this._userService.getUser();let n=this._chatService.getChatUser();n.username.length>0?this.chatuser=n:this.user.friends.length>0?this.chatuser=this.user.friends[0]:(this.chatuser._id="000000",this.chatuser.username="Unknown",this.chatuser.profilePicUrl="../../assets/images/defaultProfile.png"),this._chatService.chatroomUser.subscribe(n=>{this.chatuser=n,this.messages=[],this.createRoomNameAndGetMessages()}),this.createRoomNameAndGetMessages(),setInterval(()=>{this._socket.checkOnline(this.user._id,this.chatuser._id)},5e3),this._socket.chatMessage.subscribe(n=>{n.sender!=this.user._id&&n.sender==this.chatuser._id&&this.messages.unshift({sender:n.sender,messageBody:n.chatMsg})}),this._socket.online.subscribe(n=>{this.online=n})}createRoomNameAndGetMessages(){this.chatRoomName=this.user._id>this.chatuser._id?this.user._id+"."+this.chatuser._id:this.chatuser._id+"."+this.user._id,this._chatService.getMessages(this.chatRoomName).subscribe(n=>{n&&(this.messages=n.messages)})}onSubmit(){this.textMsg.trim().length>0&&(this.messages.unshift({sender:this.user._id,messageBody:this.textMsg}),this._socket.sendMessage(this.textMsg,this.user._id,this.chatuser._id),this._chatService.sendText(this.chatRoomName,{sender:this.user._id,messageBody:this.textMsg}).subscribe(n=>{let l=this.user.friends.filter(n=>n._id!=this.chatuser._id);l.unshift(this.chatuser),this.user.friends=l,this._userService.setUser(this.user)}),this.textMsg="")}}},xdPU:function(n,l,e){"use strict";var t=e("8Y7J"),s=e("SVse"),i=e("iInd"),u=e("s7LF"),r=e("wfUc"),a=e("Ouoq"),o=e("jHPu"),c=e("z5bb");e.d(l,"b",(function(){return h})),e.d(l,"c",(function(){return f})),e.d(l,"a",(function(){return _}));var h=t.ob({encapsulation:0,styles:[[".chat-content[_ngcontent-%COMP%]{height:100vh;width:100%;padding:0;margin:0 auto;background-color:#242a38}.chat-header[_ngcontent-%COMP%]{display:flex;align-items:center;height:4rem;background-color:#20242f}.chat-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{display:none}.chat-user-img[_ngcontent-%COMP%]{margin-left:2.5rem;height:2.5rem;width:2.5rem;border-radius:50%}.chat-user-content[_ngcontent-%COMP%]{padding-left:1rem;overflow:hidden}.chat-user-name[_ngcontent-%COMP%]{color:#fff;padding:0;margin:0;font-size:1.2rem}.online[_ngcontent-%COMP%]{font-size:.9rem;margin:0;color:#9ea5b4;-webkit-animation:.3s forwards showOnline;animation:.3s forwards showOnline}@-webkit-keyframes showOnline{0%{transform:translateY(100%);opacity:0}100%{transform:translateY(0);opacity:1}}@keyframes showOnline{0%{transform:translateY(100%);opacity:0}100%{transform:translateY(0);opacity:1}}.chat-container[_ngcontent-%COMP%]{width:100%;height:calc(100% - 4rem)}.message-box[_ngcontent-%COMP%]{height:calc(100% - 4rem);width:100%;max-width:50rem;padding:1rem;margin:0 auto;overflow:scroll;overflow-x:hidden;display:flex;flex-direction:column-reverse}.box[_ngcontent-%COMP%]{margin:.2rem 0;width:100%}.user2msg[_ngcontent-%COMP%]{background:#fff;border-radius:0 10px 10px;padding:.3rem .8rem;max-width:80%;color:#000;float:left;clear:both;word-wrap:break-word;box-shadow:0 3px 15px rgba(0,0,0,.6)}.usermsg[_ngcontent-%COMP%]{background-image:linear-gradient(to right bottom,#f54b64,#f75b61,#f76960,#f77660,#f78361);border-radius:10px 0 10px 10px;padding:.3rem .8rem;max-width:80%;color:#fff;float:right;word-wrap:break-word;box-shadow:3px 0 15px rgba(0,0,0,.6)}.chat-box[_ngcontent-%COMP%]{width:100%;height:4rem;padding:.5rem;display:flex;align-items:center;justify-content:space-between;background-color:#20242f}textarea[_ngcontent-%COMP%]{width:calc(100% - 3rem);max-width:45rem;height:2.5rem;padding:.5rem 1rem;margin:0;border-radius:25px;color:#fff;border:none;background-color:#495063;resize:none}.send-btn[_ngcontent-%COMP%]{height:2.5rem;width:2.5rem;display:flex;align-items:center;justify-content:center;background-image:linear-gradient(to right bottom,#f54b64,#f75b61,#f76960,#f77660,#f78361);border:none;border-radius:50%}.send-btn-img[_ngcontent-%COMP%]{height:1.2rem;width:1.2rem}.btn[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:0}[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 6px transparent;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.5)}@media screen and (max-width:575px){.chat-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{display:block;padding:.5rem;height:2.5rem;width:2.5rem}.chat-user-img[_ngcontent-%COMP%]{margin-left:0}}@media (min-width:800px){.chat-box[_ngcontent-%COMP%]{justify-content:center}textarea[_ngcontent-%COMP%]{margin-right:1rem}}"]],data:{}});function d(n){return t.Ib(0,[(n()(),t.qb(0,0,null,null,1,"p",[["class","online"]],null,null,null,null,null)),(n()(),t.Hb(-1,null,["online"]))],null,null)}function g(n){return t.Ib(0,[(n()(),t.qb(0,0,null,null,1,"div",[["class","usermsg"]],null,null,null,null,null)),(n()(),t.Hb(1,null,[" "," "]))],null,(function(n,l){n(l,1,0,l.parent.context.$implicit.messageBody)}))}function b(n){return t.Ib(0,[(n()(),t.qb(0,0,null,null,1,"div",[["class","user2msg"]],null,null,null,null,null)),(n()(),t.Hb(1,null,[" "," "]))],null,(function(n,l){n(l,1,0,l.parent.context.$implicit.messageBody)}))}function m(n){return t.Ib(0,[(n()(),t.qb(0,0,null,null,3,"div",[["class","box"]],null,null,null,null,null)),(n()(),t.fb(16777216,null,null,1,null,g)),t.pb(2,16384,null,0,s.j,[t.N,t.J],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),t.fb(0,[["elseBlock",2]],null,0,null,b))],(function(n,l){n(l,2,0,l.context.$implicit.sender==l.component.user._id,t.Bb(l,3))}),null)}function f(n){return t.Ib(0,[(n()(),t.qb(0,0,null,null,23,"div",[["class","chat-content"]],null,null,null,null,null)),(n()(),t.qb(1,0,null,null,9,"div",[["class","chat-header"]],null,null,null,null,null)),(n()(),t.qb(2,0,null,null,2,"a",[["routerLink","/friends"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(n,l,e){var s=!0;return"click"===l&&(s=!1!==t.Bb(n,3).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&s),s}),null,null)),t.pb(3,671744,null,0,i.m,[i.k,i.a,s.g],{routerLink:[0,"routerLink"]},null),(n()(),t.qb(4,0,null,null,0,"img",[["alt",""],["class","back-btn"],["src","../../assets/images/back.png"]],null,null,null,null,null)),(n()(),t.qb(5,0,null,null,0,"img",[["alt",""],["class","chat-user-img"]],[[8,"src",4]],null,null,null,null)),(n()(),t.qb(6,0,null,null,4,"div",[["class","chat-user-content"]],null,null,null,null,null)),(n()(),t.qb(7,0,null,null,1,"p",[["class","chat-user-name"]],null,null,null,null,null)),(n()(),t.Hb(8,null,["",""])),(n()(),t.fb(16777216,null,null,1,null,d)),t.pb(10,16384,null,0,s.j,[t.N,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t.qb(11,0,null,null,12,"div",[["class","chat-container"]],null,null,null,null,null)),(n()(),t.qb(12,0,null,null,2,"div",[["class","message-box"]],null,null,null,null,null)),(n()(),t.fb(16777216,null,null,1,null,m)),t.pb(14,278528,null,0,s.i,[t.N,t.J,t.q],{ngForOf:[0,"ngForOf"]},null),(n()(),t.qb(15,0,null,null,8,"div",[["class","chat-box"]],null,null,null,null,null)),(n()(),t.qb(16,0,null,null,5,"textarea",[["placeholder","Type your message here"],["rows","1"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(n,l,e){var s=!0,i=n.component;return"input"===l&&(s=!1!==t.Bb(n,17)._handleInput(e.target.value)&&s),"blur"===l&&(s=!1!==t.Bb(n,17).onTouched()&&s),"compositionstart"===l&&(s=!1!==t.Bb(n,17)._compositionStart()&&s),"compositionend"===l&&(s=!1!==t.Bb(n,17)._compositionEnd(e.target.value)&&s),"ngModelChange"===l&&(s=!1!==(i.textMsg=e)&&s),s}),null,null)),t.pb(17,16384,null,0,u.c,[t.B,t.k,[2,u.a]],null,null),t.Eb(1024,null,u.l,(function(n){return[n]}),[u.c]),t.pb(19,671744,null,0,u.p,[[8,null],[8,null],[8,null],[6,u.l]],{model:[0,"model"]},{update:"ngModelChange"}),t.Eb(2048,null,u.m,null,[u.p]),t.pb(21,16384,null,0,u.n,[[4,u.m]],null,null),(n()(),t.qb(22,0,null,null,1,"div",[["class","send-btn"]],null,[[null,"click"]],(function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.onSubmit()&&t),t}),null,null)),(n()(),t.qb(23,0,null,null,0,"img",[["alt",""],["class","send-btn-img"],["src","../../assets/images/send.png"]],null,null,null,null,null))],(function(n,l){var e=l.component;n(l,3,0,"/friends"),n(l,10,0,e.online),n(l,14,0,e.messages),n(l,19,0,e.textMsg)}),(function(n,l){var e=l.component;n(l,2,0,t.Bb(l,3).target,t.Bb(l,3).href),n(l,5,0,t.ub(1,"",e.chatuser.profilePicUrl,"")),n(l,8,0,e.chatuser.username),n(l,16,0,t.Bb(l,21).ngClassUntouched,t.Bb(l,21).ngClassTouched,t.Bb(l,21).ngClassPristine,t.Bb(l,21).ngClassDirty,t.Bb(l,21).ngClassValid,t.Bb(l,21).ngClassInvalid,t.Bb(l,21).ngClassPending)}))}function p(n){return t.Ib(0,[(n()(),t.qb(0,0,null,null,1,"app-chatroom",[],null,null,null,f,h)),t.pb(1,114688,null,0,r.a,[a.a,o.a,c.a],null,null)],(function(n,l){n(l,1,0)}),null)}var _=t.mb("app-chatroom",r.a,p,{},{},[])}}]);